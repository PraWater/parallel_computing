# Take Home Exercise - 3

## Overview

Number of rows and columns has been hardcoded in [histogram_mpi.c](histogram_mpi.c).

The rows to be averaged by a particular process are randomly generated by the process itself.

Number of processes is mentioned in the [makefile](Makefile).

> **Assumption:** The number of rows of the matrix is divisible by the number of processes.

Compile & run using:

```bash
make run
```

## MPI

### a) Sending messages

Each process sends all the averages calculated by it to all other processes except to itself.

 ```c
  for (int process_no = 0; process_no < comm_sz; ++process_no) {
    if (process_no == my_rank) // Instead of sending messages to self, adding to histogram
      for (int i = 0; i < rows_per_process; ++i)
        ++histogram[my_avgs[i]];
    else {
      for (int i = 0; i < rows_per_process; ++i)
        MPI_Send(&my_avgs[i], 1, MPI_INT, process_no, 0, MPI_COMM_WORLD);
    }
  }
```

### b) Receiving messages

Each process receives *(No. of rows) - (No. of rows / No. of processes)* messages ands to the histogram.

 ```c
  for (int i = 0; i < rows_per_process * (comm_sz - 1); ++i) {
    int avg;
    MPI_Recv(&avg, 1, MPI_INT, MPI_ANY_SOURCE, 0, MPI_COMM_WORLD,
             MPI_STATUS_IGNORE);
    ++histogram[avg];
  }
```
